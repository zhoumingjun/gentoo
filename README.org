#+TITLE: Readme
#+PROPERTY: header-args:bash    :results verbatim :exports both

* Overview
This repo records my experience about gentoo usage.

* Office Machine
Build a big kernel without modules.

Add nessency firmware.

Boot with [[https://www.rodsbooks.com/refind/][The rEFInd Boot Manager]]

** Steps
1. copy config from a running linux distro.
#+begin_src
zcat /proc/config.gz /usr/src/linux/.config
#+end_src

2. Update current config converting local mods to core
#+begin_src
make localyesconfig
#+end_src

3. tuning drivers

4. tuning cpu

** References
- https://wiki.gentoo.org/wiki/Intel
- https://wiki.gentoo.org/wiki/Wifi
** Drivers
#+begin_src bash
lspci -k
#+end_src

#+RESULTS:
#+begin_example
00:00.0 Host bridge: Intel Corporation 8th Gen Core Processor Host Bridge/DRAM Registers (rev 07)
	Subsystem: ASUSTeK Computer Inc. PRIME H310M-D
	Kernel driver in use: skl_uncore
00:02.0 VGA compatible controller: Intel Corporation CometLake-S GT2 [UHD Graphics 630]
	DeviceName:  Onboard IGD
	Subsystem: ASUSTeK Computer Inc. CometLake-S GT2 [UHD Graphics 630]
	Kernel driver in use: i915
00:14.0 USB controller: Intel Corporation 200 Series/Z370 Chipset Family USB 3.0 xHCI Controller
	Subsystem: ASUSTeK Computer Inc. 200 Series/Z370 Chipset Family USB 3.0 xHCI Controller
	Kernel driver in use: xhci_hcd
00:16.0 Communication controller: Intel Corporation 200 Series PCH CSME HECI #1
	Subsystem: ASUSTeK Computer Inc. 200 Series PCH CSME HECI
	Kernel driver in use: mei_me
00:17.0 SATA controller: Intel Corporation 200 Series PCH SATA controller [AHCI mode]
	Subsystem: ASUSTeK Computer Inc. 200 Series PCH SATA controller [AHCI mode]
	Kernel driver in use: ahci
00:1b.0 PCI bridge: Intel Corporation 200 Series PCH PCI Express Root Port #17 (rev f0)
	Kernel driver in use: pcieport
00:1c.0 PCI bridge: Intel Corporation 200 Series PCH PCI Express Root Port #1 (rev f0)
	Kernel driver in use: pcieport
00:1c.4 PCI bridge: Intel Corporation 200 Series PCH PCI Express Root Port #5 (rev f0)
	Kernel driver in use: pcieport
00:1d.0 PCI bridge: Intel Corporation 200 Series PCH PCI Express Root Port #9 (rev f0)
	Kernel driver in use: pcieport
00:1f.0 ISA bridge: Intel Corporation Z370 Chipset LPC/eSPI Controller
	Subsystem: ASUSTeK Computer Inc. Z370 Chipset LPC/eSPI Controller
00:1f.2 Memory controller: Intel Corporation 200 Series/Z370 Chipset Family Power Management Controller
	Subsystem: ASUSTeK Computer Inc. 200 Series/Z370 Chipset Family Power Management Controller
00:1f.3 Audio device: Intel Corporation 200 Series PCH HD Audio
	Subsystem: ASUSTeK Computer Inc. 200 Series PCH HD Audio
	Kernel driver in use: snd_hda_intel
00:1f.4 SMBus: Intel Corporation 200 Series/Z370 Chipset Family SMBus Controller
	Subsystem: ASUSTeK Computer Inc. 200 Series/Z370 Chipset Family SMBus Controller
	Kernel driver in use: i801_smbus
00:1f.6 Ethernet controller: Intel Corporation Ethernet Connection (2) I219-V
	Subsystem: ASUSTeK Computer Inc. Ethernet Connection (2) I219-V
	Kernel driver in use: e1000e
03:00.0 USB controller: ASMedia Technology Inc. ASM2142 USB 3.1 Host Controller
	Subsystem: ASUSTeK Computer Inc. ASM2142 USB 3.1 Host Controller
	Kernel driver in use: xhci_hcd
#+end_example


#+begin_src bash
lsusb

#+end_src

#+RESULTS:
#+begin_example
Bus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 002 Device 003: ID 0424:5744 Microchip Technology, Inc. (formerly SMSC) Hub
Bus 002 Device 002: ID 0bda:0409 Realtek Semiconductor Corp. 4-Port USB 3.0 Hub
Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 001 Device 003: ID 0424:2744 Microchip Technology, Inc. (formerly SMSC) Hub
Bus 001 Device 004: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)
Bus 001 Device 002: ID 0bda:5409 Realtek Semiconductor Corp. 4-Port USB 2.0 Hub
Bus 001 Device 006: ID 046d:c07f Logitech, Inc. Gaming Mouse G302
Bus 001 Device 005: ID 060b:7a03 Solid Year USB Keyboard
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
#+end_example

#+begin_src bash :dir /usr/src/linux
lshw | grep -i driver | perl -pe 's/^.*driver=(\S+).*$/$1/g;' | sort -u
#+end_src

#+RESULTS:
#+begin_example
ahci
e1000e
i801_smbus
i915
mei_me
pcieport
rtc_cmos
serial
skl_uncore
snd_hda_intel
system
xhci_hcd
#+end_example


** Tips
